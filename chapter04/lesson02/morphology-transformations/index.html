<!DOCTYPE html>
<html lang="Farsi">
<head>

<title>پردازش تصویر در OpenCV | تبدیل‌های مورفولوژی پیچیده</title>

<meta charset="utf-8">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="">
<meta property="og:url" content="https://adavoudi.github.io/opencv-book">
<meta property="og:site_name" content="پردازش تصویر در OpenCV">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="">

<link rel="short icon" href="/static/img/mira.png">
<link href="/opencv-book/static/node_modules/bulma-rtl/css/bulma-rtl.css" rel="stylesheet">
<link href="/opencv-book/static/zero60/style.css" rel="stylesheet">
<link href="/opencv-book/static/zero60/agate.css" rel="stylesheet">

<link href="https://cdn.jsdelivr.net/gh/rastikerdar/sahel-font@v2.0.2/dist/font-face.css" rel="stylesheet" type="text/css" />
 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/contrib/auto-render.min.js"></script>

</head>
<body>

  <header class="hero is-info columns">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">
              <a href="/opencv-book">
                پردازش تصویر در OpenCV
              </a>
            </h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
    <span class="sidebar_toggle">
        <em class="open-icon"></em>
    </span>
</header>

  <section class="main-content columns is-fullheight">
    <aside id="sidebar" class="column is-one-quarter-desktop is-one-third-tablet section ">
  <div class="sidebar__inner">
    <ul class="menu-list">
        
        <li>
        
        
          <span class="season">فصل اول - معرفی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter01/lesson01/ocv-intro/">- معرفی اُ سی وی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson02/load-show-save/">- بارگذاری، نمایش و ذخیره تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson03/mat-class/">- کلاس MAT</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson04/store-retrieve/">- ذخیره سازی و بازیابی اطلاعات</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل دوم - حوزهٔ مکان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter02/lesson01/simple-shapes/">- شکل‌های هندسی ساده</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson02/linear-blend/">- ترکیب خطی دو تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson03/linear-filter/">- فیلتر خطی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson04/affine-transformation/">- تبدیل اَفاین</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson05/map/">- نگاشت</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson06/contrast-brightness/">- تغییر کنتراست و روشنایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson07/smoothing/">- هموار سازی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson08/border/">- اضافه کردن قاب به تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson09/drawing/">- مولد عدد تصادفی و ترسیم متن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson10/zooming/">- بزرگ‌نمایی و کوچک‌نمایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson11/threshold/">- آستانه‌گذاری</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson12/image-histogram/">- بافت‌نگار تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson13/equalize-histogram/">- برابرسازی بافت‌نگار</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson14/sobel-operator/">- عملگر سابل</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson15/laplace-operator/">- عملگر لاپلاس</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson16/canny-operator/">- عملگر کَنی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson17/contours/">- کانتورهای تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson18/convex-hull/">- پوش محدب</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson19/contours-frames/">- قاب‌های مستطیلی و دایره‌ای برای کانتورها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson20/contours-rotated-frames/">- قاب‌های چرخیدهٔ مستطیلی و بیضوی برای کانتورها</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل سوم - حوزهٔ زمان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter03/lesson01/discrete-fourier/">- تبدیل فوریهٔ گسسته</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل چهارم - مورفولوژی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter04/lesson01/erode-dilate/">- فرسایش و گشایش</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter04/lesson02/morphology-transformations/">- تبدیل‌های مورفولوژی پیچیده</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل پنجم - شناسایی الگو</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter05/lesson01/compare-histograms/">- مقایسه بافت‌نگارها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson02/back-projection/">- بَک پروجکشن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson03/pattern-matching/">- تطبیق الگو</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson04/hough-line-transform/">- تبدیل خط هاف</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson05/hough-circle-transform/">- تبدیل دایره هاف</a>
            </li>
        
        </ul>
        </li>
        
    </ul>
  </div>
</aside>

    <div class="container column">
        <div class="section" id="content">

  
      
          <h1 class="list">فصل چهارم - مورفولوژی</h1>
      

    <h3 class="list">تبدیل‌های مورفولوژی پیچیده</h3>

    <div class="content-body content">
    <a name="more"></a>
<p>در این بخش به بررسی نحوه اعمال عملیات‌های مورفولوژی پیچیده مثل باز کردن<a href="#fn:a" id="fnref:a" class="footnote">1</a>، بستن<a href="#fn:b" id="fnref:b" class="footnote">2</a>، گرادیان به روش مورفولوژی، تاپ هَت<a href="#fn:c" id="fnref:c" class="footnote">3</a>و بلک هَت<a href="#fn:d" id="fnref:d" class="footnote">4</a> می‌پردازیم. تمام این اعمال بر پایه عملیات فرسایش و گشایش به وجود آمده‌اند. در ادامه توضیح مختصری در مورد هر کدام از این اعمال می‌دهیم.</p>

<p><strong>باز کردن:</strong></p>

<p>از طریقِ گشایش گرفتن از فرسایش یافتهٔ یک تصویر به دست می‌آید:</p>

<p>$$dst = open\left( src,\ element \right) = dilate\left(erode\left( src,\ element \right) \right)$$</p>

<p>این عمل برای از بین بردن اشیای کوچک مناسب است (بافرض اینکه اشیا به رنگ روشن و روی زمینهٔ تیره قرار داشته باشند). به شکل زیر نگاه کنید. تصویر سمت چپ تصویر ورودی و تصویر سمت راست نتیجهٔ عملیات باز کردن است. همانطور که می‌بینید ناحیه‌های کوچک بین حرف ناپدید شده‌اند.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image117.png" alt="نتیجه اعمال باز کردن روی تصویر سمت چپ" id="نتیجه_اعمال_باز_کردن_روی_تصویر_سمت_چپ"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه اعمال باز کردن روی تصویر سمت چپ</td>
</tr>
</tbody>
</table>

<p><strong>بستن:</strong></p>

<p>از طریق فرسایش گرفتن از گشایش یافتهٔ یک تصویر به دست می‌آید:</p>

<p>$$dst = close\left( src,\ element \right) = erode\left( dilate\left( src,\ element \right) \right)$$</p>

<p>این عمل برای از بین بردن حفره‌های کوچک مناسب است (نواحی تیره).</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image118.png" alt="نتیجه اعمال بستن روی تصویر سمت چپ" id="نتیجه_اعمال_بستن_روی_تصویر_سمت_چپ"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه اعمال بستن روی تصویر سمت چپ</td>
</tr>
</tbody>
</table>

<p><strong>گرادیان به روش مورفولوژی:</strong></p>

<p>از اختلاف بین گشایش و فرسایش یک تصویر به دست می‌آید:</p>

<p>$$dst = morph_{\text{grad}}\left( src,element \right) = dilate\left( src,\ element \right) - erode(src,\ element)$$</p>

<p>این عمل برای پیدا کردن محیط یک شیء مناسب است.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image119.png" alt="نتیجه اعمال گرادیان به روش مورفولوژی روی تصویر سمت چپ" id="نتیجه_اعمال_گرادیان_به_روش_مورفولوژی_روی_تصویر_سمت_چپ"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه اعمال گرادیان به روش مورفولوژی روی تصویر سمت چپ</td>
</tr>
</tbody>
</table>

<p><strong>تاپ هَت:</strong></p>

<p>از اختلاف بین یک تصویر با باز شدهٔ آن به دست می‌آید:</p>

<p>$$dst = tophat\left( src,\ element \right) = src - open(src,\ element)$$</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image120.png" alt="نتیجه اعمال تاپ هَت روی تصویر سمت چپ" id="نتیجه_اعمال_تاپ_هَت_روی_تصویر_سمت_چپ"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه اعمال تاپ هَت روی تصویر سمت چپ</td>
</tr>
</tbody>
</table>

<p><strong>بلک هَت:</strong></p>

<p>از اختلاف بین بسته شدهٔ یک تصویر با خودش به دست می‌آید:</p>

<p>$$dst = blackhat\left( src,\ element \right) = close\left( src,\ element \right) - src$$</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image121.png" alt="نتیجه اعمال بلک هَت روی تصویر سمت چپ" id="نتیجه_اعمال_بلک_هَت_روی_تصویر_سمت_چپ"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه اعمال بلک هَت روی تصویر سمت چپ</td>
</tr>
</tbody>
</table>

<h2 id="کد">کد</h2>

<pre><code class="language-c++">#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

using namespace cv;

/// Global variables
Mat src, dst;

int morph_elem = 0;
int morph_size = 0;
int morph_operator = 0;
int const max_operator = 4;
int const max_elem = 2;
int const max_kernel_size = 21;

char* window_name = "Morphology Transformations Demo";

/** Function Headers */
void Morphology_Operations( int, void* );

/** @function main */
int main( int argc, char** argv )
{
  /// Load an image
  src = imread( argv[1] );

  if( !src.data )
  { return -1; }

 /// Create window
 namedWindow( window_name, CV_WINDOW_AUTOSIZE );

 /// Create Trackbar to select Morphology operation
 createTrackbar("Operator:\n 0: Opening - 1: Closing \n 2: Gradient - 3: Top Hat \n 4: Black Hat",
                window_name, &amp;morph_operator, max_operator, Morphology_Operations );

 /// Create Trackbar to select kernel type
 createTrackbar( "Element:\n 0: Rect - 1: Cross - 2: Ellipse", window_name,
                 &amp;morph_elem, max_elem,
                 Morphology_Operations );

 /// Create Trackbar to choose kernel size
 createTrackbar( "Kernel size:\n 2n +1", window_name,
                 &amp;morph_size, max_kernel_size,
                 Morphology_Operations );

 /// Default start
 Morphology_Operations( 0, 0 );

 waitKey(0);
 return 0;
 }

 /**
  * @function Morphology_Operations
  */
void Morphology_Operations( int, void* )
{
  // Since MORPH_X : 2,3,4,5 and 6
  int operation = morph_operator + 2;

  Mat element = getStructuringElement( morph_elem, Size( 2*morph_size + 1, 2*morph_size+1 ),
                                      Point( morph_size, morph_size ) );

  /// Apply the specified morphology operation
  morphologyEx( src, dst, operation, element );
  imshow( window_name, dst );
}
</code></pre>

<h2 id="توضیح">توضیح</h2>

<p>در خط 68 از تابع MorphologyEx برای انجام عملیات مورفولوژی روی تصویر ورودی استفاده می‌شود. این تابع چهار آرگومان دارد:</p>

<ul>
<li><p>src: تصویر ورودی</p></li>
<li><p>dst: تصویر خروجی</p></li>
<li><p>operation: نوع تبدیل مورفولوژی‌ای که باید اعمال شود. از پنج مقدار زیر می‌توان استفاده کرد:</p>

<ul>
<li><p>بازکردن: MORPH_OPEN: 2</p></li>
<li><p>بستن: MORPH_CLOSE: 3</p></li>
<li><p>گرادیان: MORPH_GRADIENT: 4</p></li>
<li><p>تاپ هَت: MORPH_TOPHAT: 5</p></li>
<li><p>بلک هَت: MORPH_BLACKHAT: 6</p></li>
</ul>

<p>به خاطر اینکه مقدارها بین دو و شش است، در خط 62 دو واحد به مقدار گرفته شده از ترک‌بار اضافه می‌کنیم.</p></li>
<li><p>element: کرنل مورد استفاده است. از تابع getStructuringElement برای ساخت آن استفاده شده است.</p></li>
</ul>

<h2 id="خروجی">خروجی</h2>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image122.png" alt="تصویر ورودی" id="تصویر_ورودی"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">تصویر ورودی</td>
</tr>
</tbody>
</table>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image123.png" alt="نمایی از برنامه – سمت راست عمل بلک هَت و سمت چپ عمل باز کردن" id="نمایی_از_برنامه___سمت_راست_عمل_بلک_هَت_و_سمت_چپ_عمل_باز_کردن"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نمایی از برنامه – سمت راست عمل بلک هَت و سمت چپ عمل باز کردن</td>
</tr>
</tbody>
</table>

<div class="footnotes">
<hr>
<ol>

<li id="fn:a"><p>Opening<a href="#fnref:a" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:b"><p>Closing<a href="#fnref:b" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:c"><p>Top Hat<a href="#fnref:c" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:d"><p>Black Hat<a href="#fnref:d" class="reversefootnote">&#160;&#8617;</a></p></li>

</ol>
</div>
    </div>
  


</div>

<div class="section">
    <nav class="pagination" role="navigation" aria-label="pagination">
    <a href="/opencv-book/chapter04/lesson01/erode-dilate/" class="pagination-previous button is-primary is-outlined">
    →
    فرسایش و گشایش
  </a>




  <a href="/opencv-book/chapter05/lesson01/compare-histograms/" class="pagination-next button is-primary is-outlined">
    مقایسه بافت‌نگارها
    ←
  </a>
    </nav>
</div>
    </div>

  </section>

  <footer class="columns hero section is-dark has-text-centered">
        <div class="container ">
            <div class="columns">

                <div class="column">
                    <div class="footer-header">
                       به این جاها سر بزنید
                    </div>
                    <ul class="related-links has-text-centered">
                        <li>
                            <a href="/opencv-book/pdf/opencv-book-v1.pdf" target="_blank">دریافت کتاب با فرمت پی‌دی‌اف</a>
                        </li>
                        <li>
                            <a href="https://github.com/adavoudi/opencv-book/issues" target="_blank">گزارش مشکلات</a>
                        </li>
                    </ul>
                </div>
                <div class="column">
                    <div class="footer-header">
                    پردازش تصویر در OpenCV
                    </div>
                    <div class="socials">
                      <a href="/opencv-book">
                        <img class="cover" src="/opencv-book/media/cover-small.jpg">
                      </a>
                    </div>
                </div>


                </div>
            </div>
            <div class="has-text-centered credit">
              <div>
                ارائه شده بر بستر
                <a href="https://miraxy.github.io/" target="_blank">«میرا»</a>
                و قالب از
                <a href="https://dutymess.github.io/laravel-0-to-60/" target="_blank">
                «لاراول، از صفر تا شصت»
              </a>                
              </div>
            </div>
        </div>
    </footer>


    
<script type="text/javascript" src="/opencv-book/static/js/jquery.min.js"></script>
<script src="/opencv-book/static/js/highlight.pack.js"></script>
<script src="/opencv-book/static/js/highlightjs-line-numbers.min.js"></script>
<script src="/opencv-book/static/js/app.js"></script>

<script>
    renderMathInElement(document.body,{ delimiters:
      [
       {left: "$$", right: "$$", display: true},
       {left: "$", right: "$", display: false}
      ]
    });
</script>

<script>
    // Trim extra blank line of the codes
    var y = document.querySelectorAll("pre code");
    for(var i = 0; i < y.length; i++) {
      y[i].innerHTML = y[i].innerHTML.trimRight();
    }
</script>

</body>
</html>