<!DOCTYPE html>
<html lang="Farsi">
<head>

<title>پردازش تصویر در OpenCV | تغییر کنتراست و روشنایی تصویر</title>

<meta charset="utf-8">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="">
<meta property="og:url" content="https://h4iku.github.io/opencv-book">
<meta property="og:site_name" content="پردازش تصویر در OpenCV">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="">

  <link rel="short icon" href="/static/img/mira.png">
  <link href="/opencv-book/static/node_modules/bulma-rtl/css/bulma-rtl.css" rel="stylesheet">
  <link href="/opencv-book/static/zero60/style.css" rel="stylesheet">
  <link href="/opencv-book/static/zero60/agate.css" rel="stylesheet">
  <link href="https://cdn.rawgit.com/rastikerdar/sahel-font/v1.0.0-alpha13/dist/font-face.css" rel="stylesheet" type="text/css" />
 

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js"></script>

<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-MML-AM_CHTML' async></script> -->

</head>
<body>

  <header class="hero is-info columns">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">
              <a href="/opencv-book">
                پردازش تصویر در OpenCV
              </a>
            </h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
    <span class="sidebar_toggle">
        <em class="open-icon"></em>
    </span>
</header>

  <section class="main-content columns is-fullheight">
    <aside id="sidebar" class="column is-one-quarter-desktop is-one-third-tablet section ">
  <div class="sidebar__inner">
    <ul class="menu-list">
        
        <li>
        
        
          <span class="season">فصل اول - معرفی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter01/lesson01/ocv-intro/">- معرفی اُ سی وی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson02/load-show-save/">- بارگذاری، نمایش و ذخیره تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson03/mat-class/">- کلاس MAT</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson04/store-retrieve/">- ذخیره سازی و بازیابی اطلاعات</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل دوم - حوزهٔ مکان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter02/lesson01/simple-shapes/">- شکل‌های هندسی ساده</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson02/linear-blend/">- ترکیب خطی دو تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson03/linear-filter/">- فیلتر خطی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson04/affine-transformation/">- تبدیل اَفاین</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson05/map/">- نگاشت</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson06/contrast-brightness/">- تغییر کنتراست و روشنایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson07/smoothing/">- هموار سازی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson08/border/">- اضافه کردن قاب به تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson09/drawing/">- مولد عدد تصادفی و ترسیم متن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson10/zooming/">- بزرگ‌نمایی و کوچک‌نمایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson11/threshold/">- آستانه‌گذاری</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson12/image-histogram/">- بافت‌نگار تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson13/equalize-histogram/">- برابرسازی بافت‌نگار</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson14/sobel-operator/">- عملگر سابل</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson15/laplace-operator/">- عملگر لاپلاس</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson16/canny-operator/">- عملگر کَنی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson17/contours/">- کانتورهای تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson18/convex-hull/">- پوش محدب</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson19/contours-frames/">- قاب‌های مستطیلی و دایره‌ای برای کانتورها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson20/contours-rotated-frames/">- قاب‌های چرخیدهٔ مستطیلی و بیضوی برای کانتورها</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل سوم - حوزهٔ زمان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter03/lesson01/discrete-fourier/">- تبدیل فوریهٔ گسسته</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل چهارم - مورفولوژی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter04/lesson01/erode-dilate/">- فرسایش و گشایش</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter04/lesson02/morphology-transformations/">- تبدیل‌های مورفولوژی پیچیده</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل پنجم - شناسایی الگو</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter05/lesson01/compare-histograms/">- مقایسه بافت‌نگارها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson02/back-projection/">- بَک پروجکشن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson03/pattern-matching/">- تطبیق الگو</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson04/hough-line-transform/">- تبدیل خط هُو</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson05/hough-circle-transform/">- تبدیل دایره هُو</a>
            </li>
        
        </ul>
        </li>
        
    </ul>
  </div>
</aside>

    <div class="container column">
        <div class="section" id="content">

  
      
          <h1 class="list">فصل دوم - حوزهٔ مکان</h1>
      

    <h3 class="list">تغییر کنتراست و روشنایی تصویر</h3>

    <div class="content-body content">
    <a name="more"></a>
<p>به طور کلی کنتراست یکی از مشخصات تصویر است که به صورت نسبت روشنایی درخشان‌ترین رنگ (سفید) به روشنایی تاریک‌ترین رنگ (سیاه) موجود در آن تصویر تعریف می‌شود. در تصاویر هر چه نسبت کنتراست بالاتر باشد مطلوب‌تر است. این مقدار نسبت بیشترین میزان روشنایی رنگ سفید به کمترین میزان روشنایی رنگ سیاه کامل را نشان می‌دهد.</p>

<p>از آنجا که کنتراست و شدت روشنایی هر دو از مشخصه‌های پیکسلی هستند، می‌خواهیم در این بخش به بهانه تغییر کنتراست و روشنایی تصاویر، شما را با تبدیل‌های پیکسلی آشنا کنیم.</p>

<p>به طور کلی اگر $f\left( i,j \right)$ مقدار تصویر ورودی در پیکسل $\left( i,j \right)$ باشد، آنگاه می‌توان با استفاده از معادله زیر و تعیین مقادیر مناسب برای $\alpha$ و $\beta$، کنتراست و روشنایی تصویر $f$ را تغییر داد:</p>

<p>$$g\left( i,j \right) = \alpha\ .\ f\left( i,j \right) + \ \beta$$</p>

<p>در اینجا $g\left( i,j \right)$ مقدار جدید تصویر در پیکسل $\left( i,j \right)$ است. با استفاده از $\alpha$ می‌توان میزان کنتراست را تغییر داد و با استفاده از $\beta$ هم می‌توان میزان روشنایی را تغییر داد. توجه کنید که اگر می‌خواهید فقط میزان روشنایی را تغییر دهید، باید $\alpha$ را یک بگذارید و عدد $\beta$ را فقط تغییر دهید. اگر هم می‌خواهید فقط میزان کنتراست را تغییر دهید کافی است عدد $\beta$ را صفر بگذارید و عدد $\alpha$ را هر آنچه می‌خواهید قرار دهید.</p>

<h2>کد</h2>

<pre><code class="language-c++">#include &lt;opencv2/core/core.hpp&gt;
#include &lt;opencv2/highgui/highgui.hpp&gt;
#include &lt;iostream&gt;

int main( int argc, char** argv )
{
    double alpha; /**&lt; Simple contrast control */
    int beta; /**&lt; Simple brightness control */

    /// Read image given by user
    cv::Mat image = cv::imread( argv[1] );
    cv::Mat new_image = cv::Mat::zeros( image.size(), image.type() );

    /// Initialize values
    std::cout &lt;&lt; " Basic Linear Transforms " &lt;&lt; std::endl;
    std::cout &lt;&lt; "-------------------------" &lt;&lt; std::endl;
    std::cout &lt;&lt; "* Enter the alpha value [1.0-3.0]: ";
    std::cin &gt;&gt; alpha;
    std::cout &lt;&lt; "* Enter the beta value [0-100]: ";
    std::cin &gt;&gt; beta;

    /// Do the operation new_image(i,j) = alpha*image(i,j) + beta
    for( int y = 0; y &lt; image.rows; y++ )
    { for( int x = 0; x &lt; image.cols; x++ )
        { for( int c = 0; c &lt; 3; c++ )
            {
                new_image.at&lt;cv::Vec3b&gt;(y,x)[c] =
                        cv::saturate_cast&lt;uchar&gt;( alpha*( image.at&lt;cv::Vec3b&gt;(y,x)[c] ) + beta );
            }
        }
    }

    /// Show stuff
    cv::imshow("Original Image", image);
    cv::imshow("New Image", new_image);
    cv::imwrite("D:/TRANSLATION/OpenCV Book for PGU/PICTURES/USED IN CODES/out2.jpg", new_image);

    /// Wait until user press some key
    cv::waitKey();

    return 0;
}
</code></pre>

<h2>توضیح</h2>

<p>در خط 12، به دلیل اینکه می‌خواهیم تغییراتی در تصویر ورودی ایجاد کنیم، یک شیء جدید Mat درست می‌کنیم. همچنین می‌خواهیم این Mat جدید ویژگی‌های زیر را هم داشته باشد:</p>

<ul>
<li>مقدار اولیهٔ صفر در همهٔ پیکسل‌ها</li>
<li>اندازه و نوع مطابق با عکس اصلی</li>
</ul>

<p>تابع Mat::zeros یک شیء Mat با اندازه و نوع داده شده بر می‌گرداند که همهٔ پیکسل‌های آن صفر است.</p>

<p>حالا برای تغییر کنتراست و روشنایی، باید به همهٔ پیکسل‌های تصویر ورودی دسترسی پیدا کنیم. به دلیل اینکه با RGB کار می‌کنیم، به ازای هر پیکسل 3 مقدار داریم (R، G و B)؛ پس باید به هر کدام از آنها جداگانه دسترسی پیدا کنیم. خطوط 23 تا 31 همین کار را انجام می‌دهند.</p>

<p>به نکات زیر توجه کنید:</p>

<ul>
<li>برای دسترسی به هر کدام از پیکسل‌ها از قاعدهٔ روبرو استفاده می‌کنیم: <code>image.at&lt;Vec3b&gt;(y,x)[c]</code> که y شماره سطر، x شماره ستون و c هم R، G یا B یعنی (0، 1 یا 2) است.</li>
<li>به خاطر اینکه عمل $\alpha.f(i,j)+\beta$ ممکن است مقادیری بزرگتر از حد مجاز یا غیر صحیح (اگر آلفا اعشاری باشد) تولید کند، از تابع saturate_cast استفاده می‌کنیم تا مطمئن شویم که مقدار معتبری در پیکسل خروجی قرار می‌گیرد.</li>
</ul>

<p>در آخر خروجی را در یک پنجره نشان می‌دهیم.</p>

<p><strong>نکته: به جای استفاده از حلقهٔ for برای اعمال فرمول بالا، می‌توانستیم از تابع زیر استفاده کنیم:</strong></p>

<pre><code class="language-c++">image.convertTo(new_image, -1, alpha, beta);
</code></pre>

<p><strong>این تابع مقدار new_image را از معادلهٔ $new_{image} = \alpha * image + \beta$ به دست می‌آورد. به هر حال هدف ما در این بخش این بود که شما را با نحوهٔ دسترسی مستقیم به پیکسل‌ها و انجام تبدیلات پیکسلی آشنا کنیم. هر دو روش خروجی یکسانی دارند.</strong></p>

<h2>خروجی</h2>

<p>برنامه را به صورت زیر اجرا می‌کنیم:</p>

<pre><code class="language-powershell">BasicLinearTransform.exe "PICTURES /2.jpg"
&gt; Basic Linear Transforms
&gt; -------------------------
&gt; * Enter the alpha value [1.0-3.0]: 1.5
&gt; * Enter the beta value [0-100]: 12
</code></pre>

<p>خروجی به صورت زیر است:</p>

<table>
<col align="center" />
<col align="center" />
<thead>
<tr>
	<th><img src="/opencv-book/media/image30.jpg" alt="تصویر ورودی" id="" /></th>
	<th><img src="/opencv-book/media/image35.jpeg" alt="تصویر خروجی" id="" /></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">تصویر ورودی</td>
	<td align="center">تصویر خروجی</td>
</tr>
</tbody>
</table>

    </div>
  


</div>

<div class="section">
    <nav class="pagination" role="navigation" aria-label="pagination">
    <a href="/opencv-book/chapter02/lesson05/map/" class="pagination-previous button is-primary is-outlined">
    →
    نگاشت
  </a>




  <a href="/opencv-book/chapter02/lesson07/smoothing/" class="pagination-next button is-primary is-outlined">
    هموار سازی تصویر
    ←
  </a>
    </nav>
</div>
    </div>

  </section>

  <footer class="columns hero section is-dark has-text-centered">
        <div class="container ">
            <div class="columns">

                <div class="column">
                    <div class="footer-header">
                       به این جاها سر بزنید
                    </div>
                    <ul class="related-links has-text-centered">
                        <li>
                            <a href="/opencv-book/pdf/opencv-book-v1.pdf" target="_blank">دریافت کتاب با فرمت پی‌دی‌اف</a>
                        </li>
                        <li>
                            <a href="https://github.com/h4iku/opencv-book/issues" target="_blank">گزارش مشکلات</a>
                        </li>
                    </ul>
                </div>
                <div class="column">
                    <div class="footer-header">
                    پردازش تصویر در OpenCV
                    </div>
                    <div class="socials">
                      <a href="/opencv-book">
                        <img class="cover" src="/opencv-book/media/cover-small.jpg">
                      </a>
                    </div>
                </div>


                </div>
            </div>
            <div class="has-text-centered credit">
              <div>
                ارائه شده بر بستر
                <a href="https://miraxy.github.io/doc-fa/" target="_blank">«میرا»</a>
                و قالب از
                <a href="https://dutymess.github.io/laravel-0-to-60/" target="_blank">
                «لاراول، از صفر تا شصت»
              </a>                
              </div>
            </div>
        </div>
    </footer>


    
<script type="text/javascript" src="/opencv-book/static/js/jquery.min.js"></script>
<script src="/opencv-book/static/js/highlight.pack.js"></script>
<script src="/opencv-book/static/js/highlightjs-line-numbers.min.js"></script>
<script src="/opencv-book/static/js/app.js"></script>

<script>
    renderMathInElement(document.body,{ delimiters:
      [
       {left: "$$", right: "$$", display: true},
       {left: "$", right: "$", display: false}
      ]
    });
</script>

<script>
    // Trim extra blank line of the codes
    var y = document.querySelectorAll("pre code");
    for(var i = 0; i < y.length; i++) {
      y[i].innerHTML = y[i].innerHTML.trimRight();
    }
</script>

</body>
</html>