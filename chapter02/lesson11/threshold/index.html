<!DOCTYPE html>
<html lang="Farsi">
<head>

<title>پردازش تصویر در OpenCV | آستانه‌گذاری</title>

<meta charset="utf-8">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="">
<meta property="og:url" content="https://adavoudi.github.io/opencv-book">
<meta property="og:site_name" content="پردازش تصویر در OpenCV">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="">

<link rel="short icon" href="/static/img/mira.png">
<link href="/opencv-book/static/node_modules/bulma-rtl/css/bulma-rtl.css" rel="stylesheet">
<link href="/opencv-book/static/zero60/style.css" rel="stylesheet">
<link href="/opencv-book/static/zero60/agate.css" rel="stylesheet">

<link href="https://cdn.jsdelivr.net/gh/rastikerdar/sahel-font@v2.0.2/dist/font-face.css" rel="stylesheet" type="text/css" />
 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/contrib/auto-render.min.js"></script>

</head>
<body>

  <header class="hero is-info columns">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">
              <a href="/opencv-book">
                پردازش تصویر در OpenCV
              </a>
            </h1>
            <h2 class="subtitle"></h2>
        </div>
    </div>
    <span class="sidebar_toggle">
        <em class="open-icon"></em>
    </span>
</header>

  <section class="main-content columns is-fullheight">
    <aside id="sidebar" class="column is-one-quarter-desktop is-one-third-tablet section ">
  <div class="sidebar__inner">
    <ul class="menu-list">
        
        <li>
        
        
          <span class="season">فصل اول - معرفی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter01/lesson01/ocv-intro/">- معرفی اُ سی وی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson02/load-show-save/">- بارگذاری، نمایش و ذخیره تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson03/mat-class/">- کلاس MAT</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter01/lesson04/store-retrieve/">- ذخیره سازی و بازیابی اطلاعات</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل دوم - حوزهٔ مکان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter02/lesson01/simple-shapes/">- شکل‌های هندسی ساده</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson02/linear-blend/">- ترکیب خطی دو تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson03/linear-filter/">- فیلتر خطی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson04/affine-transformation/">- تبدیل اَفاین</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson05/map/">- نگاشت</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson06/contrast-brightness/">- تغییر کنتراست و روشنایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson07/smoothing/">- هموار سازی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson08/border/">- اضافه کردن قاب به تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson09/drawing/">- مولد عدد تصادفی و ترسیم متن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson10/zooming/">- بزرگ‌نمایی و کوچک‌نمایی تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson11/threshold/">- آستانه‌گذاری</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson12/image-histogram/">- بافت‌نگار تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson13/equalize-histogram/">- برابرسازی بافت‌نگار</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson14/sobel-operator/">- عملگر سابل</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson15/laplace-operator/">- عملگر لاپلاس</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson16/canny-operator/">- عملگر کَنی</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson17/contours/">- کانتورهای تصویر</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson18/convex-hull/">- پوش محدب</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson19/contours-frames/">- قاب‌های مستطیلی و دایره‌ای برای کانتورها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter02/lesson20/contours-rotated-frames/">- قاب‌های چرخیدهٔ مستطیلی و بیضوی برای کانتورها</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل سوم - حوزهٔ زمان</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter03/lesson01/discrete-fourier/">- تبدیل فوریهٔ گسسته</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل چهارم - مورفولوژی</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter04/lesson01/erode-dilate/">- فرسایش و گشایش</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter04/lesson02/morphology-transformations/">- تبدیل‌های مورفولوژی پیچیده</a>
            </li>
        
        </ul>
        </li>
        
        <li>
        
        
          <span class="season">فصل پنجم - شناسایی الگو</span>
          <ul>
        
            <li>
              <a href="/opencv-book/chapter05/lesson01/compare-histograms/">- مقایسه بافت‌نگارها</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson02/back-projection/">- بَک پروجکشن</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson03/pattern-matching/">- تطبیق الگو</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson04/hough-line-transform/">- تبدیل خط هاف</a>
            </li>
        
        
            <li>
              <a href="/opencv-book/chapter05/lesson05/hough-circle-transform/">- تبدیل دایره هاف</a>
            </li>
        
        </ul>
        </li>
        
    </ul>
  </div>
</aside>

    <div class="container column">
        <div class="section" id="content">

  
      
          <h1 class="list">فصل دوم - حوزهٔ مکان</h1>
      

    <h3 class="list">آستانه‌گذاری</h3>

    <div class="content-body content">
    <a name="more"></a>
<p>در این بخش به بررسی چگونگی انجام عملیات آستانه‌گذاری تصویر به کمک تابع threshold می‌پردازیم.</p>

<p>آستانه‌گذاری ساده‌ترین روش گروه بندی است. از آستانه‌گذاری می‌توان جهت جدا سازی نواحی مختلف تصویرِ استفاده کرد. در اُ سی وی پنج نوع عمل آستانه‌گذاری وجود دارد.</p>

<p>برای ادامه این بخش فرض کنید یک تصویر مرجع با مقادیر روشنایی <code>src(x,y)</code> برای پیکسل‌های آن داریم. خط افقی آبی رنگ مقدار آستانه را نمایش می‌دهد.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image55.png" alt="تصویر مرجع و خط آستانه" id="تصویر_مرجع_و_خط_آستانه"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">تصویر مرجع و خط آستانه</td>
</tr>
</tbody>
</table>

<p><strong>آستانه‌گذاری باینری</strong><a href="#fn:a" id="fnref:a" class="footnote">1</a><strong>:</strong></p>

<p>در این نوع به صورت زیر عمل می‌شود:</p>

<p><span>
$$
dst \left( x,y \right) = \left\{ \begin{matrix}
maxVal \hspace{3em}  if \thickspace src\left( x,y \right) > thresh \\
0 \hspace{10em} otherwise
\end{matrix} \right.
$$
</span></p>

<p>یعنی اگر روشنایی پیکسل <code>src(x,y)</code> بیشتر از مقدار thresh بود، آنگاه مقدار آن پیکسل برابر با MaxVal قرار داده می‌شود. در غیر این صورت مقدار آن برابر صفر قرار داده می‌شود.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image56.png" alt="نتیجه آستانه‌گذاری باینری" id="نتیجه_آستانه‌گذاری_باینری"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری باینری</td>
</tr>
</tbody>
</table>

<p><strong>آستانه‌گذاری باینری معکوس</strong><a href="#fn:b" id="fnref:b" class="footnote">2</a><strong>:</strong></p>

<p>در این نوع به صورت زیر عمل می‌شود:</p>

<p><span>
$$
dst \left( x,y \right) = \left\{ \begin{matrix}
0 \hspace{3em} if \thickspace src \left( x,y \right) > thresh \\
maxVal \hspace{5em} otherwise
\end{matrix} \right.
$$
</span></p>

<p>یعنی اگر روشنایی پیکسل <code>src(x,y)</code> بیشتر از thresh بود، آنگاه مقدار آن پیکسل برابر با صفر قرار داده می‌شود. در غیر این صورت مقدار آن برابر MaxVal خواهد بود.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image57.png" alt="نتیجه آستانه‌گذاری باینری معکوس" id="نتیجه_آستانه‌گذاری_باینری_معکوس"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری باینری معکوس</td>
</tr>
</tbody>
</table>

<p><strong>بریدن</strong><a href="#fn:c" id="fnref:c" class="footnote">3</a><strong>:</strong></p>

<p>در این نوع به صورت زیر عمل می‌شود:</p>

<p><span>
$$
dst \left( x,y \right) = \left\{ \begin{matrix}
threshold  \hspace{3em}  if \thickspace src \left( x,y \right) > thresh \\
src\left( x,y \right) \hspace{8em} otherwise
\end{matrix} \right.
$$
</span></p>

<p>بیشترین مقدار مجاز برای پیکسل‌ها، مقدار thresh است. اگر مقدار پیکسلی بیشتر از thresh بود، مقداری از آن بریده می‌شود.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image58.png" alt="نتیجه بریدن" id="نتیجه_بریدن"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه بریدن</td>
</tr>
</tbody>
</table>

<p><strong>آستانه‌گذاری به صفر</strong><a href="#fn:d" id="fnref:d" class="footnote">4</a><strong>:</strong></p>

<p>در این نوع به صورت زیر عمل می‌شود:</p>

<p><span>
$$
dst \left( x,y \right) = \left\{ \begin{matrix}
src(x,y) \hspace{3em} if \thickspace src \left( x,y \right) > thresh \\
0\hspace{10em} otherwise
\end{matrix} \right.
$$
</span></p>

<p>اگر <code>src(x,y)</code> کوچک‌تر از thresh بود، مقدار آن صفر قرار داده خواهد شد.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image59.png" alt="نتیجه آستانه‌گذاری به صفر" id="نتیجه_آستانه‌گذاری_به_صفر"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری به صفر</td>
</tr>
</tbody>
</table>

<p><strong>آستانه‌گذاری به صفر معکوس</strong><a href="#fn:e" id="fnref:e" class="footnote">5</a><strong>:</strong></p>

<p>در این نوع به صورت زیر عمل می‌شود:</p>

<p><span>
$$
dst \left( x,y \right) = \left\{ \begin{matrix}
0 \hspace{3em} if \thickspace src\left( x,y \right) > thresh \\
src(x,y) \hspace{5em} otherwise
\end{matrix} \right.
$$
</span></p>

<p>اگر <code>src(x,y)</code> بزرگ‌تر از thresh بود، مقدار آن را صفر می‌گذاریم.</p>

<table class="markmod_table">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image60.png" alt="نتیجه آستانه‌گذاری به صفر معکوس" id="نتیجه_آستانه‌گذاری_به_صفر_معکوس"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری به صفر معکوس</td>
</tr>
</tbody>
</table>

<h2 id="کد">کد</h2>

<pre><code class="language-c++">#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/highgui/highgui.hpp"
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

using namespace cv;

/// Global variables

int threshold_value = 0;
int threshold_type = 3;
int const max_value = 255;
int const max_type = 4;
int const max_BINARY_value = 255;

Mat src, src_gray, dst;
char* window_name = "Threshold Demo";

char* trackbar_type = "Type: \n"
    " 0: Binary \n"
    " 1: Binary Inverted \n"
    " 2: Truncate \n"
    " 3: To Zero \n"
    " 4: To Zero Inverted";
char* trackbar_value = "Value";

/// Function headers
void Threshold_Demo( int, void* );

/**
 * @function main
 */
int main( int argc, char** argv )
{
  /// Load an image
  src = imread( argv[1], 1 );

  /// Convert the image to Gray
  cvtColor( src, src_gray, CV_RGB2GRAY );

  /// Create a window to display results
  namedWindow( window_name, CV_WINDOW_AUTOSIZE );

  /// Create Trackbar to choose type of Threshold
  createTrackbar( trackbar_type,
                  window_name, &amp;threshold_type,
                  max_type, Threshold_Demo );

  createTrackbar( trackbar_value,
                  window_name, &amp;threshold_value,
                  max_value, Threshold_Demo );

  /// Call the function to initialize
  Threshold_Demo( 0, 0 );

  /// Wait until user finishes program
  while(true)
  {
    int c;
    c = waitKey( 20 );
    if( (char)c == 27 )
      { break; }
   }

}


/**
 * @function Threshold_Demo
 */
void Threshold_Demo( int, void* )
{
  /* 0: Binary
     1: Binary Inverted
     2: Threshold Truncated
     3: Threshold to Zero
     4: Threshold to Zero Inverted
   */

  threshold( src_gray, dst, threshold_value, max_BINARY_value,threshold_type );

  imshow( window_name, dst );
}
</code></pre>

<h2 id="توضیح">توضیح</h2>

<p>در خط 39 تصویر ورودی را با استفاده از تابع cvtColor به فضای رنگی سیاه و سفید می‌بریم.</p>

<p>در خطوط 45 و 49 دو تِرَک‌بار برای دریافت نوع آستانه‌گذاری و مقدار آستانه از کاربر درست می‌کنیم. هر وقت کاربر مقدار یکی از ترک‌بارها را تغییر دهد، تابع Threshold_Demo صدا زده می‌شود.</p>

<p>در خط 80 از تابع threshold استفاده شده است. این تابع دارای 5 آرگومان است:</p>

<ul>
<li>src_gray: تصویر ورودی</li>
<li>dst: تصویر خروجی</li>
<li>threshold_value: مقدار آستانه است.</li>
<li>max_BINARY_value: مقداری که در آستانه‌گذاری باینری استفاده می‌شود.</li>
<li>threshold_type: نوع عمل آستانه‌گذاری است. در خطوط 73 تا 77 این نوع‌ها آورده شده‌اند.</li>
</ul>

<h2 id="خروجی">خروجی</h2>

<table class="markmod_table">
<col align="center">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image61.jpeg" alt="تصویر ورودی" id="تصویر_ورودی"></th>
	<th><img src="/opencv-book/media/image62.jpeg" alt="نتیجه آستانه‌گذاری صفر با آستانه 100" id="نتیجه_آستانه‌گذاری_صفر_با_آستانه_100"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">تصویر ورودی</td>
	<td align="center">نتیجه آستانه‌گذاری صفر با آستانه 100</td>
</tr>
</tbody>
</table>

<table class="markmod_table">
<col align="center">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image63.jpeg" alt="نتیجه آستانه‌گذاری صفر معکوس با آستانه 100" id="نتیجه_آستانه‌گذاری_صفر_معکوس_با_آستانه_100"></th>
	<th><img src="/opencv-book/media/image64.jpeg" alt="نتیجه آستانه‌گذاری باینری با آستانه 100" id="نتیجه_آستانه‌گذاری_باینری_با_آستانه_100"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری صفر معکوس با آستانه 100</td>
	<td align="center">نتیجه آستانه‌گذاری باینری با آستانه 100</td>
</tr>
</tbody>
</table>

<table class="markmod_table">
<col align="center">
<col align="center">
<thead>
<tr>
	<th><img src="/opencv-book/media/image65.jpeg" alt="نتیجه آستانه‌گذاری باینری معکوس با آستانه 100" id="نتیجه_آستانه‌گذاری_باینری_معکوس_با_آستانه_100"></th>
	<th><img src="/opencv-book/media/image66.jpeg" alt="نتیجه آستانه‌گذاری بریدن با آستانه 100" id="نتیجه_آستانه‌گذاری_بریدن_با_آستانه_100"></th>
</tr>
</thead>
<tbody>
<tr>
	<td align="center">نتیجه آستانه‌گذاری باینری معکوس با آستانه 100</td>
	<td align="center">نتیجه آستانه‌گذاری بریدن با آستانه 100</td>
</tr>
</tbody>
</table>

<div class="footnotes">
<hr>
<ol>

<li id="fn:a"><p>Threshold binary<a href="#fnref:a" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:b"><p>Threshold binary, inverted<a href="#fnref:b" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:c"><p>Truncate<a href="#fnref:c" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:d"><p>Threshold to zero<a href="#fnref:d" class="reversefootnote">&#160;&#8617;</a></p></li>

<li id="fn:e"><p>Threshold to zero, inverted<a href="#fnref:e" class="reversefootnote">&#160;&#8617;</a></p></li>

</ol>
</div>
    </div>
  


</div>

<div class="section">
    <nav class="pagination" role="navigation" aria-label="pagination">
    <a href="/opencv-book/chapter02/lesson10/zooming/" class="pagination-previous button is-primary is-outlined">
    →
    بزرگ‌نمایی و کوچک‌نمایی تصویر
  </a>




  <a href="/opencv-book/chapter02/lesson12/image-histogram/" class="pagination-next button is-primary is-outlined">
    بافت‌نگار تصویر
    ←
  </a>
    </nav>
</div>
    </div>

  </section>

  <footer class="columns hero section is-dark has-text-centered">
        <div class="container ">
            <div class="columns">

                <div class="column">
                    <div class="footer-header">
                       به این جاها سر بزنید
                    </div>
                    <ul class="related-links has-text-centered">
                        <li>
                            <a href="/opencv-book/pdf/opencv-book-v1.pdf" target="_blank">دریافت کتاب با فرمت پی‌دی‌اف</a>
                        </li>
                        <li>
                            <a href="https://github.com/adavoudi/opencv-book/issues" target="_blank">گزارش مشکلات</a>
                        </li>
                    </ul>
                </div>
                <div class="column">
                    <div class="footer-header">
                    پردازش تصویر در OpenCV
                    </div>
                    <div class="socials">
                      <a href="/opencv-book">
                        <img class="cover" src="/opencv-book/media/cover-small.jpg">
                      </a>
                    </div>
                </div>


                </div>
            </div>
            <div class="has-text-centered credit">
              <div>
                ارائه شده بر بستر
                <a href="https://miraxy.github.io/" target="_blank">«میرا»</a>
                و قالب از
                <a href="https://dutymess.github.io/laravel-0-to-60/" target="_blank">
                «لاراول، از صفر تا شصت»
              </a>                
              </div>
            </div>
        </div>
    </footer>


    
<script type="text/javascript" src="/opencv-book/static/js/jquery.min.js"></script>
<script src="/opencv-book/static/js/highlight.pack.js"></script>
<script src="/opencv-book/static/js/highlightjs-line-numbers.min.js"></script>
<script src="/opencv-book/static/js/app.js"></script>

<script>
    renderMathInElement(document.body,{ delimiters:
      [
       {left: "$$", right: "$$", display: true},
       {left: "$", right: "$", display: false}
      ]
    });
</script>

<script>
    // Trim extra blank line of the codes
    var y = document.querySelectorAll("pre code");
    for(var i = 0; i < y.length; i++) {
      y[i].innerHTML = y[i].innerHTML.trimRight();
    }
</script>

</body>
</html>